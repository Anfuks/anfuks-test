"use strict";(self.webpackChunkminima_docs=self.webpackChunkminima_docs||[]).push([[6481],{3905:function(e,n,t){t.d(n,{Zo:function(){return m},kt:function(){return p}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),d=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},m=function(e){var n=d(e.components);return a.createElement(l.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),u=d(t),p=r,h=u["".concat(l,".").concat(p)]||u[p]||c[p]||o;return t?a.createElement(h,i(i({ref:n},m),{},{components:t})):a.createElement(h,i({ref:n},m))}));function p(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=t[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},7604:function(e,n,t){t.r(n),t.d(n,{assets:function(){return m},contentTitle:function(){return l},default:function(){return p},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return c}});var a=t(7462),r=t(3366),o=(t(7294),t(3905)),i=["components"],s={sidebar_position:9},l="Archive Nodes",d={unversionedId:"runanode/archivenodes",id:"runanode/archivenodes",title:"Archive Nodes",description:"Only available from Mainnet (v1.0) onwards",source:"@site/docs/runanode/archivenodes.md",sourceDirName:"runanode",slug:"/runanode/archivenodes",permalink:"/docs/runanode/archivenodes",editUrl:"https://github.com/minima-global/minidocs/docs/runanode/archivenodes.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"Restoring lost funds",permalink:"/docs/runanode/restorefunds"},next:{title:"Terminal Commands",permalink:"/docs/runanode/terminal_commands"}},m={},c=[{value:"Purpose",id:"purpose",level:2},{value:"System Requirements",id:"system-requirements",level:2},{value:"Minimum Hardware Requirements",id:"minimum-hardware-requirements",level:3},{value:"Ports",id:"ports",level:3},{value:"Starting an Archive Node",id:"starting-an-archive-node",level:2},{value:"Manual desktop node",id:"manual-desktop-node",level:3},{value:"Examples",id:"examples",level:4},{value:"Windows",id:"windows",level:4},{value:"Mac",id:"mac",level:4},{value:"Linux",id:"linux",level:4},{value:"Docker",id:"docker",level:3},{value:"Examples",id:"examples-1",level:4},{value:"Linux VPS",id:"linux-vps",level:4},{value:"Windows",id:"windows-1",level:4},{value:"Mac",id:"mac-1",level:4},{value:"Linux desktop",id:"linux-desktop",level:4},{value:"How to check your Archive data",id:"how-to-check-your-archive-data",level:2}],u={toc:c};function p(e){var n=e.components,t=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"archive-nodes"},"Archive Nodes"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Only available from Mainnet (v1.0) onwards")),(0,o.kt)("p",null,"Archive nodes store all ",(0,o.kt)("strong",{parentName:"p"},"syncblocks")," from after the Archive node is started. "),(0,o.kt)("p",null,"Syncblocks contain a record of the Proof-of-Work (PoW) and MMR proofs for coins from each past block - transactions details and custom scripts are not stored - and can be used to re-sync any node to the correct, heaviest chain."),(0,o.kt)("h2",{id:"purpose"},"Purpose"),(0,o.kt)("p",null,"Archive nodes with a static external IP can be used to re-sync users who have lost access to their node or been offline for too long and are therefore unable to sync to the chain tip block with the IBD (Initial Blockchain Download) data alone."),(0,o.kt)("p",null,"You may also choose run a local Archive node for your own purposes (in addition to your normal node) in the case you ever need to re-sync another of your own nodes."),(0,o.kt)("p",null,"An Archive node re-sync can either be:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"A Chain Re-sync:")," if a user still has access to their node but is on the wrong chain or is unable to catch up to the latest tip block as a result of being offline for too long. ",(0,o.kt)("br",null),"\nIn the case of a chain re-sync, the user's node will not be wiped, only re-synced to the latest tip block.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"A Seed Re-sync:")," if a user has lost access to their node or device completely, they can restore access to their funds from a newly created node. Their 24 word Seed Phrase is required."))),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"A Seed Re-sync should only ever be used as a last resort in the case a user has no valid backup to restore."))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Example A - Personal Archive Node")),(0,o.kt)("p",{parentName:"blockquote"},"A user running a node on a mobile device may choose to run an Archive node locally on their laptop/desktop at home in case they lose their phone and do not have a valid backup of their node stored elsewhere.")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Example B - Archive Node as a service")),(0,o.kt)("p",{parentName:"blockquote"},"A user with a server with a static external IP can run an Archive node and share the IP:Port of their Archive node with other users who require a chain or Seed Re-sync.")),(0,o.kt)("h2",{id:"system-requirements"},"System Requirements"),(0,o.kt)("p",null,"Anyone can run an Archive node from a desktop or server."),(0,o.kt)("h3",{id:"minimum-hardware-requirements"},"Minimum Hardware Requirements"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Processing:")," 2 CPU ",(0,o.kt)("br",null),"\n",(0,o.kt)("strong",{parentName:"p"},"Memory:")," 2GB RAM",(0,o.kt)("br",null),"\n",(0,o.kt)("strong",{parentName:"p"},"Storage:")," 5GB*"),(0,o.kt)("p",null,"*This may change over time."),(0,o.kt)("h3",{id:"ports"},"Ports"),(0,o.kt)("p",null,"Archive nodes wishing to run as a service must be open to inbound connections on port 9001 (or the main custom port you have chosen)."),(0,o.kt)("h2",{id:"starting-an-archive-node"},"Starting an Archive Node"),(0,o.kt)("p",null,"When you start an Archive node, you will start storing the archive data from that point onwards, therefore you can only re-sync coins for users that are created after this point."),(0,o.kt)("p",null,"It is possible to run an Archive node from the Genesis block if you either start your Archive node within 2 months of the Genesis block or by doing a Chain Re-sync from your Archive node off an Archive node that was started at Genesis."),(0,o.kt)("h3",{id:"manual-desktop-node"},"Manual desktop node"),(0,o.kt)("p",null,"To start a Minima Archive node manually, you need to add the ",(0,o.kt)("inlineCode",{parentName:"p"},"-archive")," parameter to the start up command. "),(0,o.kt)("h4",{id:"examples"},"Examples"),(0,o.kt)("h4",{id:"windows"},"Windows"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"java -jar C:\\Users\\INSERTUSERNAME\\Downloads\\minima.jar -mdsenable -archive\n")),(0,o.kt)("h4",{id:"mac"},"Mac"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo java -jar /Users/INSERTUSERNAME/Downloads/minima.jar -mdsenable -archive\n")),(0,o.kt)("h4",{id:"linux"},"Linux"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo java -jar /home/INSERTUSERNAME/minima.jar -mdsenable -archive\n")),(0,o.kt)("p",null,"If you have an existing node that you wish to change to an archive node, you can ",(0,o.kt)("inlineCode",{parentName:"p"},"quit")," your current node from the Terminal and restart the same node, adding in the archive parameter on the start up line."),(0,o.kt)("div",{className:"admonition admonition-important alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You must make sure you restart the node using the same data folder you chose when originally starting the node. "))),(0,o.kt)("h3",{id:"docker"},"Docker"),(0,o.kt)("p",null,"To start a Minima Archive node container, you need to add the ",(0,o.kt)("inlineCode",{parentName:"p"},"-e minima_archive=true")," environment variable to the start up command. "),(0,o.kt)("h4",{id:"examples-1"},"Examples"),(0,o.kt)("h4",{id:"linux-vps"},"Linux VPS"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"docker run -d -e minima_mdspassword=123 -e minima_server=true -e minima_archive=true -v ~/minimadocker9001:/home/minima/data -p 9001-9004:9001-9004 --restart unless-stopped --name minima9001 minimaglobal/minima:latest\n")),(0,o.kt)("h4",{id:"windows-1"},"Windows"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"docker run -d -e minima_mdspassword=123 -e minima_desktop=true -e minima_archive=true -v C:\\Users\\INSERTUSERNAME\\minimadocker9001:/home/minima/data -p 9001-9004:9001-9004 --restart unless-stopped --name minima9001 minimaglobal/minima:latest\n")),(0,o.kt)("h4",{id:"mac-1"},"Mac"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"docker run -d -e minima_mdspassword=123 -e minima_desktop=true -e minima_archive=true -v ~/minimadocker8001:/home/minima/data -p 8001-8004:9001-9004 --restart unless-stopped --name minima8001 minimaglobal/minima:latest\n")),(0,o.kt)("h4",{id:"linux-desktop"},"Linux desktop"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"docker run -d -e minima_mdspassword=123 -e minima_desktop=true -e minima_archive=true -v ~/minimadocker9001:/home/minima/data -p 9001-9004:9001-9004 --restart unless-stopped --name minima9001 minimaglobal/minima:latest\n")),(0,o.kt)("p",null,"If you originally started your node without the ",(0,o.kt)("inlineCode",{parentName:"p"},"-e minima_archive=true")," environment variable, you can stop and remove your Minima container (this will not delete your minimadocker9001 data folder), then start a new Minima container including ",(0,o.kt)("inlineCode",{parentName:"p"},"-e minima_archive=true")," in the start up line. "),(0,o.kt)("div",{className:"admonition admonition-important alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You must make sure you start the new container using the same data folder you chose when originally starting the node e.g. minimadocker9001"))),(0,o.kt)("h2",{id:"how-to-check-your-archive-data"},"How to check your Archive data"),(0,o.kt)("p",null,"From the Terminal MiniDapp or Docker CLI, you can check the integrity of your Archive data by running the command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"archive action:integrity\n")),(0,o.kt)("p",null,"Example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'archive action:integrity\n{\n  "command":"archive",\n  "params":{\n    "action":"integrity"\n  },\n  "status":true,\n  "pending":false,\n  "response":{\n    "message":"Archive integrity check completed",\n    "start":1,\n    "blocks":6443,\n    "cascade":true,\n    "errors":0,\n    "recommend":"Your ArchiveDB is correct and has no errors."\n  }\n}\n')),(0,o.kt)("p",null,"This checks your archive data for missing or broken blocks."),(0,o.kt)("p",null,"If there is an error, you will need to re-sync from another archive node."))}p.isMDXComponent=!0}}]);