"use strict";(self.webpackChunkminima_docs=self.webpackChunkminima_docs||[]).push([[1811],{3905:function(e,n,t){t.d(n,{Zo:function(){return m},kt:function(){return u}});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,m=r(e,["components","mdxType","originalType","parentName"]),c=p(t),u=i,h=c["".concat(s,".").concat(u)]||c[u]||d[u]||o;return t?a.createElement(h,l(l({ref:n},m),{},{components:t})):a.createElement(h,l({ref:n},m))}));function u(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,l=new Array(o);l[0]=c;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r.mdxType="string"==typeof e?e:i,l[1]=r;for(var p=2;p<o;p++)l[p]=t[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},6217:function(e,n,t){t.r(n),t.d(n,{assets:function(){return m},contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return r},metadata:function(){return p},toc:function(){return d}});var a=t(7462),i=t(3366),o=(t(7294),t(3905)),l=["components"],r={sidebar_position:5},s="Interactive MiniDapp",p={unversionedId:"buildonminima/dapptutorial/interactiveminidapp",id:"buildonminima/dapptutorial/interactiveminidapp",title:"Interactive MiniDapp",description:"In this tutorial, we will build a MiniDapp that interacts with Minima blockchain.",source:"@site/docs/buildonminima/dapptutorial/interactiveminidapp.md",sourceDirName:"buildonminima/dapptutorial",slug:"/buildonminima/dapptutorial/interactiveminidapp",permalink:"/docs/buildonminima/dapptutorial/interactiveminidapp",editUrl:"https://github.com/minima-global/minidocs/docs/buildonminima/dapptutorial/interactiveminidapp.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Basic MiniDapp",permalink:"/docs/buildonminima/dapptutorial/basicminidapp"},next:{title:"React MiniDapp",permalink:"/docs/buildonminima/dapptutorial/reactminidapp"}},m={},d=[{value:"Introducing mds.js",id:"introducing-mdsjs",level:2},{value:"Initialising MDS (MDS.init)",id:"initialising-mds-mdsinit",level:3},{value:"Events",id:"events",level:3},{value:"Commands (MDS.cmd)",id:"commands-mdscmd",level:3},{value:"SQL (MDS.sql)",id:"sql-mdssql",level:3},{value:"Logs (MDS.log)",id:"logs-mdslog",level:3},{value:"Forms (MDS.form)",id:"forms-mdsform",level:3},{value:"Packaging your MiniDapp",id:"packaging-your-minidapp",level:2},{value:"Installing your MiniDapp",id:"installing-your-minidapp",level:2},{value:"MiniDapp Downloads",id:"minidapp-downloads",level:2},{value:"Next Steps",id:"next-steps",level:2}],c={toc:d};function u(e){var n=e.components,t=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"interactive-minidapp"},"Interactive MiniDapp"),(0,o.kt)("p",null,"In this tutorial, we will build a MiniDapp that interacts with Minima blockchain."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This tutorial uses JavaScript to create a web application. If you are not using JavaScript, you can still communicate with Minima using http to make secure RPC Get Requests. ",(0,o.kt)("br",null),"\nYou can see which Minima commands are available by typing ",(0,o.kt)("inlineCode",{parentName:"p"},"help")," on your node\u2019s CLI.  "))),(0,o.kt)("p",null,"Create a new folder for a new MiniDapp - ",(0,o.kt)("inlineCode",{parentName:"p"},"helloworld2"),"."),(0,o.kt)("p",null,"Using your basic ",(0,o.kt)("inlineCode",{parentName:"p"},"helloworld")," MiniDapp as a template, add the following files to your new folder, changing the name, version and description in the config file as you wish."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"dapp.conf"),(0,o.kt)("li",{parentName:"ol"},"favicon.ico"),(0,o.kt)("li",{parentName:"ol"},"index.html"),(0,o.kt)("li",{parentName:"ol"},"styling.css (optional)")),(0,o.kt)("p",null,"Next, we will go into how to use the MiniDapp System (MDS) and JavaScript to create a MiniDapp that interacts with the Minima blockchain."),(0,o.kt)("h2",{id:"introducing-mdsjs"},"Introducing mds.js"),(0,o.kt)("p",null,"To simplify development, a script is provided which gives you access to an MDS object that allows you to access useful properties which we will look at next.  "),(0,o.kt)("p",null,"Download ",(0,o.kt)("inlineCode",{parentName:"p"},"mds.js")," from GitHub ",(0,o.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/minima-global/Minima/master/mds/mds.js"},"here"),"."),(0,o.kt)("p",null,"Add the ",(0,o.kt)("inlineCode",{parentName:"p"},"mds.js")," file to your ",(0,o.kt)("inlineCode",{parentName:"p"},"helloworld2")," folder."),(0,o.kt)("p",null,"Add the ",(0,o.kt)("inlineCode",{parentName:"p"},"mds.js")," file as a script into the head of your ",(0,o.kt)("inlineCode",{parentName:"p"},"index.html")," file to get access to the MDS object."),(0,o.kt)("p",null,"It should look something like the below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'<head>\n    \x3c!--   The MINIMA MDS JavaScript Library --\x3e\n    <script type="text/javascript" src="mds.js"><\/script>\n    <link rel="icon" type="image/x-icon" href="favicon.ico">\n    <title>Hello World #2</title>\n</head>\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"NPM pkg is due to be released in the future."))),(0,o.kt)("p",null,"If you open the script file and have a look inside you will notice a few useful functions that exist on the MDS object.  "),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"init")," function which starts up Minima and a callback for all Minima messages.",(0,o.kt)("br",null),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"log")," allows you to log some data to the console with consistent timestamp.",(0,o.kt)("br",null),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"cmd")," allows you to run functions on the Minima command line.",(0,o.kt)("br",null),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"sql")," allows you to run sql commands on the current MiniDapp\u2019s SQL database.",(0,o.kt)("br",null),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"form")," allows you to retrieve parameters from your url.",(0,o.kt)("br",null)),(0,o.kt)("p",null,"Now that we know at a high level what each function does we can go ahead and talk about each in more detail."),(0,o.kt)("h3",{id:"initialising-mds-mdsinit"},"Initialising MDS (MDS.init)"),(0,o.kt)("p",null,"Before being able to use the Minima API and run any commands, you need to make sure you run ",(0,o.kt)("inlineCode",{parentName:"p"},"MDS.init")," first."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"init")," takes one parameter, the callback function which returns you a response object in JSON format."),(0,o.kt)("p",null,"That would look something like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"MDS.init(function(event){});\n")),(0,o.kt)("h3",{id:"events"},"Events"),(0,o.kt)("p",null,"Minima Events can be listened for, so that users can be notified when specific on-chain events occur."),(0,o.kt)("p",null,"The following events exist:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"inited"),": MDS has been initialised."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"NEWBALANCE"),": The balance of the node has changed. "),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"NEWBLOCK"),": The chain tip has changed (i.e. a new block has been added to the chain). JSON data returned: The TxPoW object of the last block is returned as a JSON Object."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"MINING"),": Mining has started or ended.\nJSON data returned: The TxPoW Object, true (if started)/false (if ended)."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"MINIMALOG"),": A new log message is available"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'MDS.init(function(msg) {\n // inited means Minima API is ready to be used\nSwitch(msg.event)\ncase: "inited":\n\n// do Minima dependent initializations\n\nbreak;\ncase "newblock":\nconsole.log(msg);\n// newblock message data\nbreak;\ncase:"mining":\n// mining messages\nconsole.log(msg);\n// mining message data\nbreak;\ncase:"newbalance":\nconsole.log(msg);\n// newbalance msg data\nbreak;\n//...\n            }\n')),(0,o.kt)("h3",{id:"commands-mdscmd"},"Commands (MDS.cmd)"),(0,o.kt)("p",null,"Now that we have initialised Minima and MDS is ready to be used, we can run useful commands to interface with Minima using the ",(0,o.kt)("inlineCode",{parentName:"p"},"cmd")," function property."),(0,o.kt)("p",null,"Minima Terminal commands can be executed within JavaScript functions. "),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cmd")," takes two parameters, the name of the function you want to run and the callback function which returns you a response object in JSON format."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"MDS.cmd(minimaCommand,callback)\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example: "),"   "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'MDS.cmd("balance", function(res){\nconsole.log(res);\n{\n/**\n  "command":"balance",\n  "status":true,\n  "response":[{\n    "token":"Minima",\n    "tokenid":"0x00",\n    "confirmed":"0",\n    "unconfirmed":"1000000000",\n    "sendable":"0",\n    "coins":"1",\n    "total":"1000000000"\n  }]\n}\n*/\n});\n')),(0,o.kt)("p",null,"For the full list of terminal commands, run ",(0,o.kt)("inlineCode",{parentName:"p"},"help")," from the Minima Command Line, additional details can be found ",(0,o.kt)("a",{parentName:"p",href:"/docs/runanode/terminal_commands"},"here.")),(0,o.kt)("h3",{id:"sql-mdssql"},"SQL (MDS.sql)"),(0,o.kt)("p",null,"An instance of a MySQL database is available for every MiniDapp.  You can create tables, insert, delete and query as you would any database using MDS.sql."),(0,o.kt)("p",null,"Under the hood is the H2 Java database engine, where you can do normal CRUD operations as you would.  There may be some minor differences between MySQL and MySQL with H2.  Read more ",(0,o.kt)("a",{parentName:"p",href:"https://www.h2database.com/html/main.html"},"here"),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"sql")," takes two parameters, the query string and a callback function."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Examples:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"MDS.sql(sqlQuery, callback);\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'MDS.sql("CREATE TABLE IF NOT EXISTS CUSTOMTABLE values(...)", function(res));\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'MDS.sql("INSERT INTO table_name (column1, column2, column3, ...)\nVALUES (value1, value2, value3, ...)", function(res));\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'MDS.sql("CREATE TABLE IF NOT EXISTS MESSAGES...", function(res));\n')),(0,o.kt)("h3",{id:"logs-mdslog"},"Logs (MDS.log)"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"log")," is a simple helper function that will output to the browser's console a time stamped message of your choice. This is useful for debugging."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'MDS.log("this is a time stamped message");\n')),(0,o.kt)("h3",{id:"forms-mdsform"},"Forms (MDS.form)"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"MDS.form")," handles form submissions.",(0,o.kt)("br",{parentName:"p"}),"\n","It has a property called getParams which will collect URL parameters."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example")),(0,o.kt)("p",null,"The example ",(0,o.kt)("inlineCode",{parentName:"p"},"index.html")," file below provides a simple example of showing the latest block number and querying the node Status, using the Minima status command."),(0,o.kt)("p",null,"Copy and paste the code into your ",(0,o.kt)("inlineCode",{parentName:"p"},"index.html")," file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'<html>\n<head>\n    \x3c!--   The MINIMA MDS JavaScript Library --\x3e\n    <script type="text/javascript" src="mds.js"><\/script>\n    \n    <link rel="icon" type="image/x-icon" href="favicon.ico">\n    \n    <title>Hello World</title>\n\n</head>\n<body>\n<style></style>\n\n<h2>Hello World!</h2>\n<p>Current Minima Block Height: <span id="block-height"></span></p>\n<p>Current Node Status: <span id="node-status"></span></p>\n\n<button onclick=\'runStatus();\'>CHECK STATUS</button>\n\n<script type="text/javascript">\n\n    function runStatus(){\n        \n        // run the Minima status command to return information about the node\'s current state\n        MDS.cmd("status", function(res) {\n            \n            //if the response status is true\n            if (res.status) {\n                //  convert the JSON object response to a string and format it\n                const nodeStatus = JSON.stringify(res.response, " ", \'\\t\');\n                \n                // show the response on the page\n                document.getElementById("node-status").innerText = nodeStatus;\n\n            //if the response status is false\n            }else{\n                \n                document.getElementById("node-status").innerText = "Could not retrieve current node Status";    \n    \n            }})\n        }\n    \n        //Initialise web socket \n        MDS.init(function(msg){\n            if(msg.event == "inited") {\n                // READY TO RUN CMDS!\n                // run the Minima status command to return information about the node\'s current state\n                MDS.cmd("status", function(res) {\n    \n                    if (res.status) {\n                        \n                        // get the block number from the Status object returned\n                        const blockHeight = res.response.chain.block;\n    \n                        document.getElementById("block-height").innerText = blockHeight;    \n    \n                    }\n                })          \n    \n            }else if(msg.event == "NEWBLOCK"){\n            // the chain tip has changed\n    \n            }else if(msg.event == "NEWBALANCE"){\n            // user\'s balance has changed \n            \n            }else if(msg.event == "MINING"){    \n            // mining has started or ended\n    \n            }else if(msg.event == "MINIMALOG"){\n            // new Minima log message\n    \n            }else{\n    \n                \n            }\n        });\n         \n        \n    <\/script>\n</body>\n</html>\n')),(0,o.kt)("h2",{id:"packaging-your-minidapp"},"Packaging your MiniDapp"),(0,o.kt)("p",null,"We now have a complete helloworld2 folder containing: "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"dapp.conf"),(0,o.kt)("li",{parentName:"ol"},"favicon.ico"),(0,o.kt)("li",{parentName:"ol"},"index.html"),(0,o.kt)("li",{parentName:"ol"},"styling.css (optional)"),(0,o.kt)("li",{parentName:"ol"},"mds.js")),(0,o.kt)("p",null,"Zip up the contents of this folder (not the folder itself)."),(0,o.kt)("p",null,"Rename the folder to ",(0,o.kt)("inlineCode",{parentName:"p"},"helloworld2.mds.zip")," or if you are using a zip library through your CLI run ",(0,o.kt)("inlineCode",{parentName:"p"},"zip -r helloworld2.mds.zip"),".   "),(0,o.kt)("h2",{id:"installing-your-minidapp"},"Installing your MiniDapp"),(0,o.kt)("p",null,"Please refer to the ",(0,o.kt)("a",{parentName:"p",href:"/docs/buildonminima/dapptutorial/basicminidapp#installing-your-minidapp"},"Installing your MiniDapp")," section."),(0,o.kt)("h2",{id:"minidapp-downloads"},"MiniDapp Downloads"),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"HelloWorld2")," MiniDapp can also be downloaded from GitHub ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/minima-global/innovation-challenge/tree/main/Resources"},"here")),(0,o.kt)("p",null,"Minima\u2019s official MiniDapps can be downloaded from the ",(0,o.kt)("a",{parentName:"p",href:"https://minidapps.minima.global/"},"MiniDapps website"),"."),(0,o.kt)("h2",{id:"next-steps"},"Next Steps"),(0,o.kt)("p",null,"The most powerful MiniDapps will use Smart Contracts, written in Minima's scripting language. ",(0,o.kt)("br",null),"\nPlease follow the ",(0,o.kt)("a",{parentName:"p",href:"/docs/buildonminima/txntutorial/start"},"Smart Contract Tutorial")," to learn more about writing Scripts on Minima."))}u.isMDXComponent=!0}}]);